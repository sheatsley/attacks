This looks to be it. Will run a major test in the morning but: (1) the new eps derivation for mapping out of tanh space appears to help, (2) mapping into tanh space with epsilon in tanh_p (the out of place version) also helps, and (3) yes, we must only map inputs into and out of the tanh space when necessary -- what's happening here is a form of quanitzation, if you map everything, small perturbations (ie the vast majority) all get mapped to 0, so the sample gets 'stuck' in place and the only perturbations that keep increasing are those that were already large (and have little benefit). we're winning at mnist against fb now (0 at 24.2 vs 0.13 at 24.07)
